<link rel="stylesheet" href="/styles/Admin.css" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<h1>Admin Panel</h1>

{{#each users}}
  <div class="admin-user-card">
    <h2>{{username}} ({{email}})</h2>

    <!-- Change Username Form -->
    <form action="/admin/change-username" method="POST" class="form-change-username">
      <input type="hidden" name="userId" value="{{id}}">
      <input type="text" name="newUsername" placeholder="Nieuwe gebruikersnaam" required>
      <button type="submit" class="btn change-username-btn">Wijzig naam</button>
    </form>

    <!-- Delete User Form -->
    <form action="/admin/delete-user" method="POST" class="form-delete-user" onsubmit="return confirm('Verwijder deze gebruiker?');">
      <input type="hidden" name="userId" value="{{id}}">
      <button type="submit" class="btn delete-user-btn">Verwijder gebruiker</button>
    </form>

    <h3>Karakters</h3>
    {{#if characters.length}}
      <ul>
        {{#each characters}}
          <li>
            {{name}}
            <form action="/admin/delete-character" method="POST" class="form-delete-character" style="display:inline;">
              <input type="hidden" name="characterId" value="{{id}}">
              <button type="submit" class="btn delete-character-btn">ðŸ—‘</button>
            </form>
          </li>
        {{/each}}
      </ul>
    {{else}}
      <p>Geen karakters</p>
    {{/if}}

    <h3>Pending Taken</h3>
    {{#if tasks.length}}
      <ul>
        {{#each tasks}}
          <li>
            {{title}}
            <form action="/admin/finish-task" method="POST" class="form-finish-task" style="display:inline;">
              <input type="hidden" name="taskId" value="{{id}}">
              <button type="submit" class="btn finish-task-btn">Finish</button>
            </form>
            <form action="/admin/delete-task" method="POST" class="form-delete-task" style="display:inline;">
              <input type="hidden" name="taskId" value="{{id}}">
              <button type="submit" class="btn delete-task-btn">Delete</button>
            </form>
          </li>
        {{/each}}
      </ul>
    {{else}}
      <p>Geen pending taken</p>
    {{/if}}
  </div>
{{/each}}

<!-- SweetAlert Error -->
{{#if error}}
<script>
  Swal.fire({
    icon: 'error',
    title: 'Toegang geweigerd',
    text: '{{error}}',
    confirmButtonColor: '#d33'
  });
</script>
{{/if}}
